(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[339],{5202:function(e,r,t){Promise.resolve().then(t.bind(t,435))},435:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var n=t(3150),o=t(6443),s=t(3209),i=t(3062),a=t.n(i),l=t(9579),u=t(2306),c=t(2608);function d(){let{logout:e}=(0,o.useAuth)(),r=async()=>{await e("".concat(c.env.NEXT_PUBLIC_AUTH_URL,"/login"))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a(),{children:(0,n.jsx)("title",{children:"Acesso Negado | Backoffice"})}),(0,n.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background",children:(0,n.jsxs)("div",{className:"w-full max-w-md rounded-lg border border-border bg-card p-8 shadow-sm",children:[(0,n.jsxs)("div",{className:"mb-6 flex flex-col items-center",children:[(0,n.jsx)("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10",children:(0,n.jsx)(l.Z,{className:"h-8 w-8 text-destructive"})}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Acesso Negado"})]}),(0,n.jsx)("div",{className:"mb-6 text-center text-muted-foreground",children:(0,n.jsx)("p",{className:"mb-2",children:"Voc\xea n\xe3o tem permiss\xe3o para acessar o painel administrativo."})}),(0,n.jsx)("div",{className:"flex flex-col gap-4",children:(0,n.jsxs)(s.z,{variant:"destructive",onClick:r,className:"w-full",children:[(0,n.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Sair"]})})]})})]})}},6257:function(e,r,t){"use strict";t.d(r,{Z:function(){return d}});var n=t(2145);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase()),i=e=>{let r=s(e);return r.charAt(0).toUpperCase()+r.slice(1)},a=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()},l=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,n.forwardRef)((e,r)=>{let{color:t="currentColor",size:o=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:f,...h}=e;return(0,n.createElement)("svg",{ref:r,...u,width:o,height:o,stroke:t,strokeWidth:i?24*Number(s)/Number(o):s,className:a("lucide",c),...!d&&!l(h)&&{"aria-hidden":"true"},...h},[...f.map(e=>{let[r,t]=e;return(0,n.createElement)(r,t)}),...Array.isArray(d)?d:[d]])}),d=(e,r)=>{let t=(0,n.forwardRef)((t,s)=>{let{className:l,...u}=t;return(0,n.createElement)(c,{ref:s,iconNode:r,className:a("lucide-".concat(o(i(e))),"lucide-".concat(e),l),...u})});return t.displayName=i(e),t}},2306:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(6257).Z)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},9579:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(6257).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3062:function(e,r){"use strict";function t(){return null}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return t}}),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},6443:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return p},useAuth:function(){return x}});var n=t(3150),o=t(2145),s=t(9733),i=t(2608);let a=i.env.NEXT_PUBLIC_COOKIE_NAME||"authToken",l=i.env.NEXT_PUBLIC_COOKIE_DOMAIN||"localhost",u=e=>{let{domain:r=l}=e,t={path:"/",sameSite:"lax"};return r&&(t.domain=r),t},c=e=>{let{cookieName:r=a,domain:t=l}=e;s.Z.remove(r,u({domain:t}))};var d=t(9612),f=t(68);let h=(e,r)=>!!e&&!!e.roles&&(!r||0===r.length||(e.permissions&&Array.isArray(e.permissions)?r.every(r=>e.permissions&&e.permissions.includes(r)):r.every(r=>{let[t,n]=r.split(".");return e.roles&&e.roles.some(e=>{var r;return null===(r=e.permissions)||void 0===r?void 0:r.some(e=>e.resource===t&&e.action===n)})})));var m=t(2608);async function v(e){try{let{payload:r}=await d._(e,new TextEncoder().encode(""),{requiredClaims:[],clockTolerance:"1000y"}).catch(()=>({payload:f.t(e)}));return r}catch(e){return console.error("Error decoding JWT token:",e),null}}let g=(0,o.createContext)(void 0),p=e=>{let{children:r,cookieName:t,domain:s,apiUrl:i}=e,[a,l]=(0,o.useState)(null),[u,d]=(0,o.useState)(!0),f=!!a;(0,o.useEffect)(()=>{(async()=>{try{d(!0);let e=await fetch("/api/auth/check-auth",{credentials:"include"});if(!e.ok){if(401===e.status){l(null);return}throw Error("Erro ".concat(e.status,": ").concat(e.statusText))}let r=await e.json();(null==r?void 0:r.authenticated)&&(null==r?void 0:r.user)?l(r.user):l(null)}catch(e){console.error("Auth check error:",e),l(null)}finally{d(!1)}})()},[i]);let p=async(e,r)=>{try{d(!0);let n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r}),credentials:"include"});if(!n.ok)throw Error("Erro ".concat(n.status,": ").concat(n.statusText));let o=await n.json();if(null==o?void 0:o.token){var t;let e=o.token,r=await v(e);r&&r.user?l(r.user):(null==o?void 0:o.user)&&l(o.user);let n=(null==r?void 0:r.user)||(null==o?void 0:o.user),s=(null==n?void 0:null===(t=n.roles)||void 0===t?void 0:t.some(e=>"admin"===e))?"".concat(m.env.NEXT_PUBLIC_BACKOFFICE_URL,"/dashboard"):"/dashboard";return{success:!0,redirectUrl:s}}return{success:!1,error:"Credenciais inv\xe1lidas"}}catch(e){return console.error("Erro durante o login:",e),{success:!1,error:e instanceof Error?e.message:"Ocorreu um erro durante o login."}}finally{d(!1)}},x=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/login";d(!0);try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Error during logout:",e),c({cookieName:t,domain:s})}l(null),d(!1),window.location.href=e};return(0,n.jsx)(g.Provider,{value:{user:a,setUser:l,isAuthenticated:f,isLoading:u,login:p,logout:x,hasPermissions:e=>h(a,e)},children:r})},x=()=>{let e=(0,o.useContext)(g);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3209:function(e,r,t){"use strict";t.d(r,{z:function(){return u}});var n=t(3150),o=t(2145),s=t(5893),i=t(5778),a=t(5609);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=o.forwardRef((e,r)=>{let{className:t,variant:o,size:i,asChild:u=!1,...c}=e,d=u?s.g7:"button";return(0,n.jsx)(d,{className:(0,a.cn)(l({variant:o,size:i,className:t})),ref:r,...c})});u.displayName="Button"},5609:function(e,r,t){"use strict";t.d(r,{cn:function(){return s}});var n=t(1882),o=t(2471);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.m6)((0,n.W)(r))}}},function(e){e.O(0,[651,370,946,519,744],function(){return e(e.s=5202)}),_N_E=e.O()}]);